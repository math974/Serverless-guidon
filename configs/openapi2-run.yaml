# openapi2-functions.yaml
swagger: '2.0'
info:
  title: Web Service & Discord Bot API Gateway
  description: API Gateway with endpoints for web service and Discord bot on Google Cloud Functions backend
  version: 1.0.0
schemes:
  - https
produces:
  - application/json
consumes:
  - application/json
paths:
  /discord/interactions:
    post:
      summary: Handle Discord interactions
      description: Webhook endpoint for Discord bot interactions
      operationId: discordInteractions
      x-google-backend:
        address: https://sunbot-gdu7lmfosq-ew.a.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      parameters:
        - name: X-Signature-Ed25519
          in: header
          required: true
          type: string
          description: Discord signature for request verification
        - name: X-Signature-Timestamp
          in: header
          required: true
          type: string
          description: Discord timestamp for request verification
        - name: interaction
          in: body
          required: true
          schema:
            type: object
            description: Discord interaction payload
      responses:
        '200':
          description: Successful interaction response
          schema:
            type: object
        '401':
          description: Unauthorized - Invalid signature
          schema:
            type: string
        '403':
          description: Forbidden - Invalid API key
          schema:
            type: string
  /health:
    get:
      summary: Web service health check endpoint
      description: Endpoint for checking the health status of the web service
      operationId: healthCheck
      x-google-backend:
        address: https://sunbot-gdu7lmfosq-ew.a.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      responses:
        '200':
          description: Service is healthy
          schema:
            type: object
            properties:
              status:
                type: string
              timestamp:
                type: string
        '403':
          description: Forbidden - Invalid API key
          schema:
            type: string
# securityDefinitions:
#   api_key:
#     type: 'apiKey'
#     name: 'key'
#     in: 'query'
#     description: 'API key for accessing the Discord bot endpoints'

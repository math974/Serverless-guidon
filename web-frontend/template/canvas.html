<!DOCTYPE html>
<html lang="en">
<head>
    <!-- CONFIG_PLACEHOLDER -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Epitech Pixel War</title>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/canvas.css">
</head>
<body>
    <div class="header">
        <h1>
            <img src="/assets/epitech.png" alt="Epitech" class="epitech-logo">
            <span id="canvasTitle">Pixel War</span>
        </h1>
        <div class="header-actions">
            <div class="user-info-container">
                <div class="user-info" id="userInfo" style="display: none;">
                    <img id="userAvatar" src="" alt="User" class="user-avatar">
                    <span id="userUsername" class="user-username"></span>
                    <i class="fas fa-chevron-down user-dropdown-icon"></i>
                </div>
                <div class="user-menu" id="userMenu" style="display: none;">
                    <button class="user-menu-item" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Logout</span>
                    </button>
                </div>
            </div>
            <button class="btn btn-secondary" onclick="loadCanvas()">
                <i class="fas fa-sync-alt"></i>
                Refresh
            </button>
            <button class="btn btn-secondary" onclick="exportCanvas()">
                <i class="fas fa-download"></i>
                Export PNG
            </button>
        </div>
    </div>

    <div class="container">
        <div class="canvas-section">
            <div class="canvas-wrapper">
                <canvas id="canvas" width="480" height="480"></canvas>
            </div>

            <div class="zoom-controls">
                <button class="zoom-btn" onclick="zoomOut()" title="Zoom Out">
                    <i class="fas fa-search-minus"></i>
                </button>
                <span class="zoom-level" id="zoomLevel">100%</span>
                <button class="zoom-btn" onclick="zoomIn()" title="Zoom In">
                    <i class="fas fa-search-plus"></i>
                </button>
            </div>

            <div class="coords-display" id="coordsDisplay">
                Move mouse over canvas
            </div>

            <div class="canvas-controls">
                <div class="control-group">
                    <label><i class="fas fa-fill-drip"></i> Color Picker</label>
                    <div class="color-picker-wrapper">
                        <input type="color" id="colorPicker" value="#FF0000">
                        <input type="text" id="colorInput" value="#FF0000" maxlength="7">
                    </div>
                </div>

                <div class="control-group">
                    <label><i class="fas fa-arrows-alt-h"></i> X Coordinate (0-47)</label>
                    <input type="number" id="xInput" min="0" max="47" value="24">
                </div>

                <div class="control-group">
                    <label><i class="fas fa-arrows-alt-v"></i> Y Coordinate (0-47)</label>
                    <input type="number" id="yInput" min="0" max="47" value="24">
                </div>

                <div class="control-group">
                    <button class="btn btn-primary" id="drawPixelBtn" onclick="drawPixel()">
                        <i class="fas fa-paint-brush"></i>
                        Draw Pixel
                    </button>
                </div>
            </div>

            <div class="control-group">
                <label><i class="fas fa-palette"></i> Preset Colors</label>
                <div class="preset-colors">
                    <div class="preset-color" style="background: #FF0000" onclick="setColor('#FF0000')" title="Red"></div>
                    <div class="preset-color" style="background: #00FF00" onclick="setColor('#00FF00')" title="Green"></div>
                    <div class="preset-color" style="background: #0000FF" onclick="setColor('#0000FF')" title="Blue"></div>
                    <div class="preset-color" style="background: #FFFF00" onclick="setColor('#FFFF00')" title="Yellow"></div>
                    <div class="preset-color" style="background: #FF00FF" onclick="setColor('#FF00FF')" title="Magenta"></div>
                    <div class="preset-color" style="background: #00FFFF" onclick="setColor('#00FFFF')" title="Cyan"></div>
                    <div class="preset-color" style="background: #FFA500" onclick="setColor('#FFA500')" title="Orange"></div>
                    <div class="preset-color" style="background: #800080" onclick="setColor('#800080')" title="Purple"></div>
                    <div class="preset-color" style="background: #FFC0CB" onclick="setColor('#FFC0CB')" title="Pink"></div>
                    <div class="preset-color" style="background: #A52A2A" onclick="setColor('#A52A2A')" title="Brown"></div>
                    <div class="preset-color" style="background: #000000" onclick="setColor('#000000')" title="Black"></div>
                    <div class="preset-color white-preset" style="background: #FFFFFF" onclick="setColor('#FFFFFF')" title="White"></div>
                    <div class="preset-color" style="background: #808080" onclick="setColor('#808080')" title="Gray"></div>
                    <div class="preset-color" style="background: #FFD700" onclick="setColor('#FFD700')" title="Gold"></div>
                    <div class="preset-color" style="background: #FF7F50" onclick="setColor('#FF7F50')" title="Coral"></div>
                    <div class="preset-color" style="background: #40E0D0" onclick="setColor('#40E0D0')" title="Turquoise"></div>
                </div>
            </div>
        </div>

        <div class="sidebar">
            <div class="info-panel">
                <h3><i class="fas fa-chart-bar"></i> Canvas Stats</h3>
                <div class="stat-row">
                    <span class="stat-label"><i class="fas fa-th"></i> Total Pixels</span>
                    <span class="stat-value" id="totalPixels">0</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label"><i class="fas fa-users"></i> Contributors</span>
                    <span class="stat-value" id="contributors">0</span>
                </div>
                <div class="stat-row" id="contributorsListRow">
                    <div id="contributorsList"></div>
                </div>
                <div class="stat-row">
                    <span class="stat-label"><i class="fas fa-clock"></i> Last Update</span>
                    <span class="stat-value" id="lastUpdate">Never</span>
                </div>
            </div>

            <div class="info-panel">
                <h3><i class="fas fa-history"></i> Recent Activity</h3>
                <div class="activity-feed" id="activityFeed">
                    <div class="activity-item">
                        <div>Waiting for canvas data...</div>
                    </div>
                </div>
            </div>

            <div class="info-panel">
                <h3><i class="fas fa-info-circle"></i> Info</h3>
                <div class="info-text">
                    <p><strong>How to use:</strong></p>
                    <ul>
                        <li><i class="fas fa-mouse-pointer"></i>Click on canvas to draw</li>
                        <li><i class="fas fa-palette"></i>Use color picker or presets</li>
                        <li><i class="fas fa-sync-alt"></i>Auto-refreshes every 5 seconds</li>
                        <li><i class="fas fa-info-circle"></i>Right-click for pixel info</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="loading" id="loading">
        <div class="spinner"></div>
        <div>Loading canvas...</div>
    </div>

    <div class="notification" id="notification"></div>

    <!-- Pixel Info Modal -->
    <div class="modal" id="pixelInfoModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-map-marker-alt"></i> Pixel Information</h2>
                <button class="modal-close" onclick="closePixelInfoModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="pixelInfoContent">
                <div class="pixel-info-loading">Loading...</div>
            </div>
        </div>
    </div>

    <!-- Load canvas modules in order -->
    <script src="/js/canvas-config.js"></script>
    <script src="/js/canvas-utils.js"></script>
    <script src="/js/canvas-ui.js"></script>
    <script src="/js/canvas-render.js"></script>
    <script type="module" src="/js/canvas.js"></script>
</body>
</html>
